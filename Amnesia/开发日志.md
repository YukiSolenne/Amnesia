# 开发日志

2025-9-23 day2

昨天用qwen-7b-chat跑通了之后超兴奋，发小红书广而告之。

今天换了deepseek-r1-distill-qwen-14b，这个模型还挺不错的。

前端报错了。



> *(.venv) PS D:\Amnesia> & d:/Amnesia/.venv/Scripts/python.exe d:/Amnesia/scripts/chat_to_card.py*
> *写下一段要封存的记忆：*
>
> 想念你的心情就像水从瓶子里溢出
>
> Traceback (most recent call last):
> File "d:\Amnesia\scripts\chat_to_card.py", line 166, in <module>
> main()
> File "d:\Amnesia\scripts\chat_to_card.py", line 137, in main
> resp = call_chat_completion(BASE, KEY, MODEL, msg, temperature=0.7, timeout=120)
>       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> File "d:\Amnesia\scripts\openai_client.py", line 23, in call_chat_completion    
> with request.urlopen(req, timeout=timeout) as resp:
>     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> File "C:\Users\nagi\AppData\Local\Programs\Python\Python311\Lib\urllib\request.py", line 216, in urlopen
> return opener.open(url, data, timeout)
>       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> File "C:\Users\nagi\AppData\Local\Programs\Python\Python311\Lib\urllib\request.py", line 519, in open
> response = self._open(req, data)
>           ^^^^^^^^^^^^^^^^^^^^^
> File "C:\Users\nagi\AppData\Local\Programs\Python\Python311\Lib\urllib\request.py", line 536, in _open
> result = self._call_chain(self.handle_open, protocol, protocol +
>         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> File "C:\Users\nagi\AppData\Local\Programs\Python\Python311\Lib\urllib\request.py", line 496, in _call_chain
> result = func(*args)
>         ^^^^^^^^^^^
> File "C:\Users\nagi\AppData\Local\Programs\Python\Python311\Lib\urllib\request.py", line 1377, in http_open
> return self.do_open(http.client.HTTPConnection, req)
>       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> File "C:\Users\nagi\AppData\Local\Programs\Python\Python311\Lib\urllib\request.py", line 1352, in do_open
> r = h.getresponse()
>    ^^^^^^^^^^^^^^^
> File "C:\Users\nagi\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 1390, in getresponse
> response.begin()
> File "C:\Users\nagi\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 325, in begin
> version, status, reason = self._read_status()
>                          ^^^^^^^^^^^^^^^^^^^
> File "C:\Users\nagi\AppData\Local\Programs\Python\Python311\Lib\http\client.py", line 286, in _read_status
> line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
>           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
> File "C:\Users\nagi\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
> return self._sock.recv_into(b)
>       ^^^^^^^^^^^^^^^^^^^^^^^
> TimeoutError: timed out

然后这是LM Studio后端（这么称呼真的没错吗）

> "content": "<think>
>
> 首先，我需要分析用户的输入：“想念你的心情就像水从瓶子里溢出”。这句话表达了强烈的思念之情，用“水溢出”这个比喻来形象地描述情感的无法抑制。
>
> 
>
> 接下来，我要构建draft对象。总结部分要简洁中立，所以我会写“用户以水流溢出为喻，表达深切的思念之情”。关键词包括“想念”、“水”和“瓶子”。
>
> 
>
> 然后是情感光谱部分。由于思念通常是积极的情感，但带有一定的悲伤色彩，所以我将valence设为0.6，表示较为正面但略带负面的情绪。唤醒度设置为0.8，因为这种情绪往往让人感到激动或投入。tones选择“怀旧”和“深情”，符合思念的主题。
>
> 
>
> 接下来是隐喻域的选择。用户使用了水溢出的比喻，这与“暴风雪”这个选项不符，更接近于液体流动的情况，但提供的选项中没有完全匹配的。考虑到情感的强烈和无法抑制，我可能需要选择最接近的一个，或者可能重新审视选项是否遗漏了其他可能性。假设只能从给定的四个选项中选，“焰火花”可能不太合适，而“暴风雪”虽然强度大，但更偏向于情绪的爆发，所以这里可能更适合选择“水”相关的隐喻，不过在选项中并没有，因此可能需要调整或者说明。
>
> 
>
> 最后，metaphor_seed设为1024，保持与",

很棒的思考，比qwen7b要棒多了。但是好像因为话太多被截断了

![image-20250923122938973](C:\Users\nagi\AppData\Roaming\Typora\typora-user-images\image-20250923122938973.png)

可恶，我的C盘飘红了。

![image-20250923143638664](C:\Users\nagi\AppData\Roaming\Typora\typora-user-images\image-20250923143638664.png) ![image-20250923143714913](C:\Users\nagi\AppData\Roaming\Typora\typora-user-images\image-20250923143714913.png)

deepseek就是聪明。

修改了一下格式，jsonl里面还是没能看见thinking内容，但是后端能够很清楚地看见。呈现得很清晰。
